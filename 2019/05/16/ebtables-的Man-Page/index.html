<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="ebtables çš„ Man Page"><link rel="alternate" href="/atom.xml" title="J.A.R.V.I.S"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0">
<link rel="canonical" href="https://pwn4justice.github.io/2019/05/16/ebtables-çš„Man-Page/">

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css"><link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css">
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0">

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true,"latex":false};
</script>

    <title>ebtables çš„ Man Page - J.A.R.V.I.S</title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">J.A.R.V.I.S</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">é¦–é¡µ
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">å…³äº
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">J.A.R.V.I.S</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            é¦–é¡µ
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            å…³äº
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">ebtables çš„ Man Page
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-05-16
        </span></div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#ç”¨æ³•"><span class="toc-text">ç”¨æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è¡¨-ä¸‰å¼ "><span class="toc-text">è¡¨ - ä¸‰å¼ </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CHAINS-è‹¥å¹²"><span class="toc-text">CHAINS - è‹¥å¹²</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TARGETS"><span class="toc-text">TARGETS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ebtables-å‘½ä»¤çš„ä½¿ç”¨åŠå‚æ•°è¯´æ˜"><span class="toc-text">ebtables å‘½ä»¤çš„ä½¿ç”¨åŠå‚æ•°è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è§„åˆ™è¯´æ˜"><span class="toc-text">è§„åˆ™è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ‰©å±•é€‰é¡¹-EXTENSIONS"><span class="toc-text">æ‰©å±•é€‰é¡¹ EXTENSIONS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è§‚å¯Ÿè€…æ‰©å±•-WATCHER-EXTENSIONS"><span class="toc-text">è§‚å¯Ÿè€…æ‰©å±• WATCHER EXTENSIONS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç›®æ ‡æ‰©å±•-TARGET-EXTENSIONS"><span class="toc-text">ç›®æ ‡æ‰©å±• TARGET EXTENSIONS</span></a></li></ol>
    </div>
  </div><div class="post-content"><p>ä»¥ä¸‹å†…å®¹ç¿»è¯‘è‡ª ebtables çš„ Man é¡µ</p>
<a id="more"></a>

<h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>-</strong>[<strong>ACDI</strong>] chain rule specification [match extensions] [watcher extensions] target<br><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>-P</strong> chain <strong>ACCEPT</strong> | <strong>DROP</strong> | <strong>RETURN</strong><br><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>-F</strong> [chain]<br><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>-Z</strong> [chain]<br><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>-L</strong> [<strong>-Z</strong>] [chain] [ [<strong>â€“Ln</strong>] | [<strong>â€“Lx</strong>] ] [<strong>â€“Lc</strong>] [<strong>â€“Lmac2</strong>]<br><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>-N</strong> chain [<strong>-P ACCEPT</strong> | <strong>DROP</strong> | <strong>RETURN</strong>]<br><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>-X</strong> [chain]<br><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>-E</strong> old-chain-name new-chain-name<br><strong>ebtables</strong> [<strong>-t</strong> table ] <strong>â€“init-table</strong><br><strong>ebtables</strong> [<strong>-t</strong> table ] [<strong>â€“atomic-file</strong> file] <strong>â€“atomic-commit</strong><br><strong>ebtables</strong> [<strong>-t</strong> table ] [<strong>â€“atomic-file</strong> file] <strong>â€“atomic-init</strong><br><strong>ebtables</strong> [<strong>-t</strong> table ] [<strong>â€“atomic-file</strong> file] <strong>â€“atomic-save</strong> </p>
<p>æ³¨ï¼š-t å¦‚æœæœ‰ï¼Œå¿…é¡»ç¬¬ä¸€ä¸ªå†™ã€‚</p>
<br>

<h3 id="è¡¨-ä¸‰å¼ "><a href="#è¡¨-ä¸‰å¼ " class="headerlink" title="è¡¨ - ä¸‰å¼ "></a>è¡¨ - ä¸‰å¼ </h3><ul>
<li>filter - é»˜è®¤è¡¨ã€‚<ul>
<li>å†…å»ºçš„é“¾ï¼š<strong>INPUT</strong> {å¸§[åœ¨MACå±‚é¢ä¸Š]å°±æ˜¯å‘ç»™ç½‘æ¡¥çš„æ—¶å€™[å³å¸§çš„ç›®çš„MACåœ°å€å°±æ˜¯ç½‘æ¡¥æ—¶]ä¼šç»è¿‡è¿™æ¡é“¾chain } </li>
<li><strong>OUTPUT</strong> { é€‚ç”¨äºæœ¬åœ°ç”Ÿæˆçš„å¸§ï¼Œæˆ–è€…æ˜¯(b)routedçš„å¸§ï¼Œï¼Œï¼Œè¯è¯´routedæˆ‘çŸ¥é“æ˜¯è·¯ç”±æ—¶IPå±‚ä¸‹æ¥çš„ï¼Œä½†æ˜¯broutedæ˜¯<strong>ä»€ä¹ˆé¬¼ï¼Ÿï¼Ÿ</strong>  }</li>
<li><strong>FORWARD</strong> { é€‚ç”¨äºè¢«ç½‘æ¡¥è½¬å‘çš„å¸§ }</li>
</ul>
</li>
<li>nat - æœ€å¸¸ç”¨æ¥æ”¹å˜å¸§çš„ç›®çš„macåœ°å€<ul>
<li>å†…å»ºçš„é“¾ï¼š<strong>PREROUTING</strong> { é€‚ç”¨äºåœ¨å¸§åˆšè¿›ä¸»æœºï¼ˆè·¯ç”±å™¨ï¼‰çš„æ—¶å€™ }</li>
<li><strong>OUTPUT</strong> { for altering locally generated or (b)routed frames before they are bridged }</li>
<li><strong>POSTROUTING</strong> { é€‚ç”¨äºå¸§é©¬ä¸Šè¦ç¦»å¼€ä¸»æœºï¼ˆè·¯ç”±å™¨ï¼‰çš„æ—¶å€™ }</li>
<li>æ³¨ï¼šPREROUTING and POSTROUTING: it would be more accurate to call them PREFORWARDING and POSTFORWARDINGï¼Œä¸”ä½ å¯ä»¥ä½¿ç”¨ -E é€‰é¡¹æ¥å°†å…¶æ”¹å</li>
</ul>
</li>
<li>broute - ç»å¸¸è¢«ç”¨æ¥ make a brouter ???<ul>
<li>åªæœ‰ä¸€æ¡å†…å»ºçš„é“¾ï¼š<strong>BROUTING</strong> , ä¸”è¿™ä¸ªè¡¨ä¸­çš„ <strong>DROP</strong> å’Œ <strong>ACCEPT</strong> åˆ†åˆ«è¡¨ç¤ºâ€è®©å…¶è¢«è·¯ç”±â€œå’Œâ€è®©å…¶è¢«æ¡¥æ¥â€œ</li>
<li>BROUTING chain åœ¨å¾ˆæ—©å°±ä¼šè¢«å¸§æ‹¿æ¥åšåŒ¹é…ï¼Œå½“ç„¶åªèƒ½è¿è¡Œâ€æµç»<strong>è½¬å‘çŠ¶æ€çš„ç«¯å£</strong>çš„å¸§â€œæ¥åŒ¹é…ï¼Œæ­¤å¤„targetå¸¸ç”¨<code>redirect</code></li>
</ul>
</li>
</ul>
<br>

<h3 id="CHAINS-è‹¥å¹²"><a href="#CHAINS-è‹¥å¹²" class="headerlink" title="CHAINS - è‹¥å¹²"></a>CHAINS - è‹¥å¹²</h3><p><strong>ç†è§£æ–¹å¼ä¸€ï¼š</strong></p>
<p>å†…æ ¸ä¸­æœ‰ä¸‰å¼ å†…åµŒæœ‰CHAINSçš„è¡¨ã€‚ä¸‰å¼ è¡¨æŒ‰åŠŸèƒ½åˆ’åˆ†ï¼Œæ¯ä¸ªåŠŸèƒ½ï¼ˆä¹Ÿå°±æ˜¯è¡¨ï¼‰ä¸­ç”¨è¯¥åŠŸèƒ½ç›¸é€‚åº”çš„â€œè§„åˆ™â€ã€‚æ¯ä¸€æ¡è§„åˆ™å°±æ˜¯ä¸€ä¸ªchainã€‚</p>
<p>æ¯ä¸€æ¡chainéƒ½æ˜¯ä¸€ä¸ªæœ‰ç‰¹å®šé¡ºåºçš„â€œé“¾è¡¨â€ï¼Œç”¨æ¥åšä¸€æ¬¡ä»¥å¤ªç½‘å¸§çš„åŒ¹é…ã€‚å¦‚æœï¼ŒæŸä¸ªä»¥å¤ªç½‘å¸§åŒ¹é…åˆ°äº†ä¸€æ¡chainï¼Œé‚£ä¹ˆå°±å¯¹è¯¥å¸§æ‰§è¡Œ</p>
<p>è¿™æ¡chainä¸Šçš„ targetã€‚å¦‚æœè¿™ä¸ªå¸§æ²¡æœ‰åŒ¹é…ä¸Šè¿™æ¡chainï¼Œé‚£ä¹ˆç»§ç»­åŒ¹é…ä¸‹ä¸€è·³chainï¼Œç”¨æˆ·å¯ä»¥æ‰©å±•ä¸€æ¡chainï¼ˆåˆ›å»ºchainçš„ç¬¬äºŒä¸ª</p>
<p>å¾€åçš„ç»“ç‚¹ï¼‰ç„¶åä½¿ç”¨ â€œå¤´ç»“ç‚¹â€ chain â€œheadâ€ çš„ target åŸŸæ¥è¿æ¥ã€‚</p>
<p><em>ç†è§£æ–¹å¼ä¸é‡è¦ï¼Œè§£å†³é—®é¢˜æ‰é‡è¦ã€‚</em></p>
<p><strong>ç†è§£æ–¹å¼äºŒï¼š</strong> ï¼ˆè¿™ä¸ªæ‰æ˜¯æ­£è§£ï¼‰</p>
<p>å†…æ ¸ä¸­æœ‰ä¸‰å¼ å†…åµŒæœ‰CHAINSçš„è¡¨ã€‚ä¸‰å¼ è¡¨æŒ‰åŠŸèƒ½åˆ’åˆ†ï¼Œæ¯ä¸ªåŠŸèƒ½ï¼ˆä¹Ÿå°±æ˜¯è¡¨ï¼‰ä¸­ç”¨è¯¥åŠŸèƒ½ç›¸é€‚åº”çš„â€œè§„åˆ™â€ã€‚æ¯â€ä¸€ç±»è§„åˆ™â€œé›†å°±æ˜¯ä¸€ä¸ªchainã€‚</p>
<p>å¦‚INPUT chainï¼ŒOUTPUT chain ç­‰ï¼Œæ¯ä¸€æ¡ chain éƒ½æ˜¯æœ‰ç‰¹å®šé¡ºåºçš„è§„åˆ™ï¼Œç”¨æ¥ä¾æ¬¡åšä»¥å¤ªç½‘å¸§çš„åŒ¹é…ã€‚å¦‚æœï¼ŒæŸä¸ªä»¥å¤ªç½‘å¸§åŒ¹é…åˆ°äº†ä¸€</p>
<p>æ¡ chain ä¸­çš„æŸä¸€ä¸ªè§„åˆ™ï¼Œé‚£ä¹ˆå°±å¯¹è¯¥å¸§æ‰§è¡Œè¿™æ¡è§„åˆ™ä¸Šçš„ target ã€‚å¦‚æœè¿™ä¸ªå¸§æ²¡æœ‰åŒ¹é…ä¸Šè¿™æ¡è§„åˆ™ï¼Œé‚£ä¹ˆç»§ç»­åŒ¹é…æ”¹chainä¸­çš„ä¸‹ä¸€æ¡è§„åˆ™ï¼Œ</p>
<p>ç”¨æˆ·å¯ä»¥æ‰©å±•ä¸€æ¡chainï¼ˆåˆ›å»ºä¸€ç±»æ–°çš„è§„åˆ™é›†ï¼‰ç„¶åä½¿ç”¨å†…å»ºçš„è§„åˆ™é›†ï¼ˆchainï¼‰çš„ target åŸŸæ¥è¿æ¥ã€‚</p>
<br>

<p><strong>ææ¸…æ¥šä¸Šæ–‡çš„é—®å·éƒ¨åˆ†ï¼šä»€ä¹ˆæ˜¯ brouter(â€˜before routeâ€™ or â€˜bridge routeâ€™)ï¼Œä»€ä¹ˆæ˜¯è½¬å‘çŠ¶æ€çš„ç«¯å£ï¼Œä»€ä¹ˆæ˜¯redirectï¼Œæ€ä¹ˆç†è§£broute</strong></p>
<ul>
<li>brouter å³ bridge router ï¼Œèƒ½æ¡¥æ¥åˆèƒ½è·¯ç”±çš„è·¯ç”±å™¨ï¼ˆç›®å‰å¤§éƒ¨åˆ†éƒ½æ˜¯è¿™æ ·ï¼‰</li>
<li>REDIRECTï¼šä¼šæ”¹å˜ç›®æ ‡MACåœ°å€ï¼Œåœ¨BROUTINGé“¾é‡Œä½¿ç”¨æ—¶ï¼ŒMACåœ°å€è¢«æ”¹ä¸ºæ¡¥ç«¯å£åœ°å€ï¼›åœ¨natè¡¨çš„PREROUTINGé“¾ä¸­ä½¿ç”¨æ—¶ï¼Œä¼šæ”¹ä¸ºç½‘æ¡¥çš„åœ°å€</li>
<li>brouteï¼šå³è·¯ç”±æˆ–è€…åˆ¤æ–­è·¯ç”±è¿˜æ˜¯æ¡¥æ¥çš„è¿‡ç¨‹</li>
<li>è½¬å‘çŠ¶æ€çš„æ¥å£ï¼šè¢«ç”¨æ¥è¿›è¡Œâ€ç«¯å£è½¬å‘â€çš„ç½‘å¡æ¥å£ï¼ˆinterfaceï¼‰</li>
</ul>
<br>

<h3 id="TARGETS"><a href="#TARGETS" class="headerlink" title="TARGETS"></a>TARGETS</h3><p>1.ACCEPT<br>2.DROP - ä¸¢ï¼Œä¸é€šçŸ¥<br>3.CONTINUE - å¿…é¡»å»åŒ¹é…ä¸‹ä¸€ä¸ªè§„åˆ™ï¼ˆruleï¼‰<br>4.RETURN - æœ‰ç‚¹å‡½æ•°è¿”å›çš„æ„å‘³ã€‚åœæ­¢ç»§ç»­åŒ¹é…è¿™æ¡ chain ä¸Šï¼ˆé‡‡ç”¨ç†è§£æ–¹å¼äºŒï¼‰çš„è§„åˆ™ï¼Œè½¬è€Œå»åŒ¹é…ä»â€è°ƒç”¨â€œï¼ˆé€šè¿‡targetåŸŸè°ƒç”¨ï¼‰è¿™æ¡chain çš„é‚£ä¸ª chain çš„ä¸‹ä¸€æ¡è§„åˆ™ã€‚<br>5.EXTENSION<br>6.jump to a user-defined chain</p>
<p>æ³¨ï¼š In the <strong>BROUTING</strong> chain however, the <strong>ACCEPT</strong> and <strong>DROP</strong> target have different meanings.</p>
<br>

<h3 id="ebtables-å‘½ä»¤çš„ä½¿ç”¨åŠå‚æ•°è¯´æ˜"><a href="#ebtables-å‘½ä»¤çš„ä½¿ç”¨åŠå‚æ•°è¯´æ˜" class="headerlink" title="ebtables å‘½ä»¤çš„ä½¿ç”¨åŠå‚æ•°è¯´æ˜"></a>ebtables å‘½ä»¤çš„ä½¿ç”¨åŠå‚æ•°è¯´æ˜</h3><p>æ³¨ï¼šä¸€èˆ¬ä¸€æ¬¡åªèƒ½è¾“å…¥ä¸€æ¡å‘½ä»¤ï¼Œé™¤é <code>-L</code> å’Œ <code>-Z</code> åŒæ—¶ä½¿ç”¨ï¼›æˆ–è€…<code>-N</code> <code>-P</code>åŒæ—¶ä½¿ç”¨ï¼›æˆ–è€…ä½¿ç”¨äº†<code>--atomic-file</code></p>
<p>-D, --delete</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-D start_nr[:end_nr] æˆ–è€…-D complete-ruleï¼Œå¯ä»¥ä½¿ç”¨è´Ÿæ•°</p>
<p>-C, --change-counters</p>
<p>-I, --insert</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-I rule [åœ¨æŸä¸ªç‰¹å®šçš„ä½ç½®ï¼Œä¸€èˆ¬æ˜¯æŸä¸€ä¸ªchainçš„æœ€å¼€å§‹]æ’å…¥ä¸€æ¡ruleï¼Œå¦‚æœç°åœ¨æŸä¸ªchainå·²ç»æœ‰äº†Næ¡è§„åˆ™ï¼Œé‚£ä¹ˆåœ¨ iï¼ˆi&gt;0ï¼‰å‡ºæ’å…¥å’Œåœ¨ i-N-1 å¤„æ’å…¥æ˜¯ä¸€æ ·çš„ã€‚å½“è¦ä¸€æ¬¡æ€§æ’å…¥å¤šæ¡è§„åˆ™æ—¶ï¼Œä»¤ i ä¸¥æ ¼å°äº 0 æ˜¯æœ‰å¥½å¤„çš„ã€‚</p>
<p>-P, --policy</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;è®¾ç½®chainçš„é»˜è®¤targetï¼ŒACCEPTã€DROPã€RETURN</p>
<p>-F, --flush</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;é™¤éä½ æŒ‡å®šä¸€æ¡chainï¼Œå¦åˆ™æ¸…é™¤æ‰€æœ‰chainçš„è§„åˆ™</p>
<p>-Z, --zero</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;é™¤éä½ æŒ‡å®šä¸€æ¡chainï¼Œå¦åˆ™è®¾ç½®æ‰€æœ‰chainçš„åŒ¹é…è®¡æ•°ä¸º0ï¼Œä¸-Lè¿ç”¨æ—¶ï¼Œä¼šå…ˆprintå‡ºå·²æœ‰çš„åŒ¹é…è®¡æ•°</p>
<p>-L, --list</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;é™¤éä½ æŒ‡å®šä¸€æ¡chainï¼Œå¦åˆ™æ‰€æœ‰chainçš„è§„åˆ™éƒ½åˆ—å‡ºæ¥</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â€“Ln åˆ—å‡ºæ‰€æœ‰è§„åˆ™çš„rule numberï¼ˆå³åœ¨chainä¸­çš„åºå·ï¼‰ï¼Œä¸â€“Lxä¸å…¼å®¹</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â€“Lc åœ¨åˆ—å‡ºè§„åˆ™åŒæ—¶ä¹Ÿå±•ç¤ºåŒ¹é…çš„å¸§çš„æ•°é‡(pcnt)å’Œå­—èŠ‚è®¡æ•°(bcnt)ï¼Œä¸â€“Lxé…åˆæ—¶å¯ä»¥ç¾åŒ–åŒ¹é…è®¡æ•°çš„æ˜¾ç¤º</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â€“Lx </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â€“Lmac2 å±•ç¤ºå®Œæ•´çš„macåœ°å€</p>
<p>-N, --new-chain</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰é“¾ï¼Œè‡ªå®šä¹‰é“¾çš„æœ€å¤§åå­—é•¿åº¦ä¸º31ä¸ªå­—ç¬¦ï¼Œé»˜è®¤targetæ˜¯ACCEPTï¼Œä½†å¯è¾…åŠ©ä»¥-Pä¿®æ”¹</p>
<p>-X, --delete-chain</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åˆ é™¤ä¸€æ¡æ²¡æœ‰è¢«å¼•ç”¨çš„ç”¨æˆ·è‡ªå®šä¹‰é“¾ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šåˆ™åˆ é™¤æ‰€æœ‰æ²¡è¢«å¼•ç”¨çš„è‡ªå®šä¹‰chain</p>
<p>-E, --rename-chain</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¯ä»¥é‡å‘½åè‡ªå®šä¹‰é“¾æˆ–è€…å†…å»ºçš„é“¾ï¼Œä½œç”¨ä¸æ˜¯å¾ˆå¤§ï¼Œå¦‚æœæ›´æ”¹åˆ™åœ¨æäº¤é—®é¢˜çš„æ—¶å€™æ³¨æ„å†™æ˜ã€‚</p>
<p>--init-table</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å°†å½“å‰tableçš„æ•°æ®ç”¨åˆå§‹æ•°æ®è¦†ç›–</p>
<p>--atomic-init</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å°†å†…æ ¸ä¸­ä¿å­˜çš„è¯¥tableçš„åŸå§‹æ•°æ®ä¿å­˜åˆ°ä¸€ä¸ªç‰¹å®šæ–‡ä»¶ä¸­å»ï¼ˆç›¸å½“äºæœ€åˆè¯•çš„å¿«ç…§ï¼‰</p>
<p>--atomic-save</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å°†å†…æ ¸ä¸­ä¿å­˜çš„è¯¥tableçš„ç›®å‰çš„æ•°æ®ä¿å­˜åˆ°ä¸€ä¸ªç‰¹å®šæ–‡ä»¶ä¸­å»ï¼ˆç›¸å½“äºå¤‡ä»½ï¼‰</p>
<p>--atomic-commit</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¯ä»¥å°†ä¸€ä¸ªç‰¹å®šæ–‡ä»¶ä¸­çš„æ•°æ®æäº¤åˆ°å¹¶è¦†ç›–å†…æ ¸ä¸­çš„æ•°æ®</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>ä½¿ç”¨æ­¥éª¤ï¼š</strong></p>
<ol>
<li><p>å…ˆå°†ä½¿ç”¨ â€“atomic-init æˆ–è€… â€“atomic-save äº§ç”Ÿçš„tableæ•°æ®æ–‡ä»¶ä½¿ç”¨<code>--atomic-file</code> åŠ è½½åˆ°å½“å‰çš„é˜²ç«å¢™table</p>
</li>
<li><p>åŠ è½½æ–‡ä»¶è‡³é˜²ç«å¢™tableï¼ˆæ­¤æ—¶è¿˜æ²¡åˆ·æ–°å†…æ ¸ä¸­çš„æ•°æ®å‘¢ï¼‰è¿˜æœ‰å¦ä¸€é€”å¾„å°±æ˜¯ï¼šè®¾ç½®<em>EBTABLES_ATOMIC_FILE</em> ç¯å¢ƒå˜é‡</p>
</li>
<li><p>ä½¿ç”¨<code>--atomic-commit</code> æäº¤å¹¶ä¿®æ”¹å†…æ ¸ä¸­çš„æ•°æ®</p>
</li>
<li><p>åœ¨æ“ä½œç³»ç»Ÿèµ·å§‹çš„ boot script ä¸­ååˆ†æœ‰ç”¨ï¼Œç”¨æ¥æ„å»ºå¿«é€Ÿ ebtables</p>
</li>
</ol>
<br>

<p>-V, --version</p>
<p>-h, --help [list of module names]</p>
<p>-j, --jump <em>target</em></p>
<p>--atomic-file <em>file</em></p>
<p>-M, --modprobe <em>program</em> : ä¸å†…æ ¸äº¤äº’æ—¶ï¼Œä½¿ç”¨ <em>program</em> å°è¯•è‡ªåŠ¨åŠ è½½æŸä¸ªç¼ºå¤±çš„å†…æ ¸æ¨¡å—</p>
<p>--concurrent : è®¾ç½®ä¸€ä¸ªé”é˜²æ­¢è„šæœ¬ä»¬å¹¶å‘åœ°ä¿®æ”¹å†…æ ¸ä¸­ç»´æŠ¤çš„ ebtables è¡¨</p>
<br>

<h3 id="è§„åˆ™è¯´æ˜"><a href="#è§„åˆ™è¯´æ˜" class="headerlink" title="è§„åˆ™è¯´æ˜"></a>è§„åˆ™è¯´æ˜</h3><p>-p, --protocol [!] <em>protocol</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åˆ›é€ å‡ºä¸€ä¸ªå¸§æ‰€ä½¿ç”¨çš„åè®®ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå¤§äº 0x0600 çš„16è¿›åˆ¶æ•° æˆ–<strong>é•¿åº¦</strong>ã€‚ä»¥å¤ªç½‘å¸§çš„åè®®åŸŸå¯ä»¥ç”¨æ¥æŒ‡ç¤ºå¤´éƒ¨çš„é•¿åº¦ã€‚å½“è¯¥åŸŸçš„å€¼å°äºæˆ–ç­‰äº 0x0600æ—¶ï¼Œé‚£ä¹ˆè¯¥å€¼å°±ç­‰äºå¸§å¤´çš„å¤§å°å¹¶ä¸”ä¸èƒ½è¢«ç”¨ä½œåè®®å·ã€‚ç›¸åï¼Œæ‰€æœ‰åè®®åŸŸè¢«ç”¨ä½œé•¿åº¦åŸŸæ—¶çš„å¸§é€šå¸¸ä¼šè¢«è®¤ä¸ºä½¿ç”¨äº†â€œå’Œé‚£ä¸ªé•¿åº¦å¯¹åº”â€çš„åè®®ã€‚è¿™äº›åè®®åœ¨è¿™äº›å¸§ä¸­çš„åå­—å°±æ˜¯é•¿åº¦(å€¼) [<strong>LENGTH</strong>)ï¼Œ<code>/etc/ethertypes</code> æ–‡ä»¶ä»¥äººç±»å¯è¯»çš„æ–¹å¼å±•ç¤ºäº†åè®®åŠå…¶çš„åå…­è¿›åˆ¶æ•°å­—ï¼Œå’Œè‹±æ–‡ç¼©å†™ã€‚æ¯”å¦‚ï¼Œ<em>0x0800</em> å°±è¡¨ç¤ºIPV4åè®®ã€‚è¿™ä¸ªæ–‡ä»¶ä¸æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œâ€“proto å¯ä»¥ç”¨æ¥æ›¿æ¢ -p</p>
<p>-i, --in-interface [!] <em>name</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¸§è¿›æ¥çš„æ¥å£(bridge port)ï¼Œè¿™ä¸ªé€‰é¡¹åœ¨ INPUT,FORWARD,PREROUTING,BROUTINGé“¾ä¸­æœ‰ç”¨ã€‚å¦‚æœæ¥å£åå­—ä»¥â€™+â€™ç»“å°¾ï¼Œé‚£ä¹ˆæ‰€æœ‰ä»¥è¯¥åå­—å¼€å¤´çš„æ¥å£éƒ½ä¼šè¢«åŒ¹é…ï¼Œå¯ä»¥ç”¨ <code>--in-if</code>  æ›¿ä»£</p>
<p>--logical-in [!] <em>name</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¸§è¿›æ¥çš„é€»è¾‘æ¥å£(å¦‚ eth0.1 è¿™æ ·çš„ï¼Ÿ)ï¼Œç”Ÿæ•ˆäºğŸ‘†æ‰€æåŠçš„å››æ¡é“¾ï¼Œä¸”+ä¹ŸåŒä¸Šã€‚</p>
<p>-o, --out-interface [!] <em>name</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å¸§è¦å¾€å“ªä¸ªæ¥å£å‘å‡º(bridge port)ï¼Œè¿™ä¸ªé€‰é¡¹åœ¨ OUTPUT,FORWARD,POSTROUTINGé“¾ä¸­æœ‰ç”¨ã€‚å¦‚æœæ¥å£åå­—ä»¥â€™+â€™ç»“å°¾ï¼Œé‚£ä¹ˆæ‰€æœ‰ä»¥è¯¥åå­—å¼€å¤´çš„æ¥å£éƒ½ä¼šè¢«åŒ¹é…ï¼Œå¯ä»¥ç”¨ <code>--out-if</code>  æ›¿ä»£</p>
<p>--logical-out [!] <em>name</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å®šä¹‰å¸§è¦å‡ºå»çš„é€»è¾‘æ¥å£(å¦‚ eth0.2 è¿™æ ·çš„ï¼Ÿ)ï¼Œç”Ÿæ•ˆäºğŸ‘†æ‰€æåŠçš„å››æ¡é“¾ï¼Œä¸”+ä¹ŸåŒä¸Šã€‚</p>
<p>-s, --source [!] <em>address[/mask]</em></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æºMACåœ°å€ï¼Œæ©ç ä¸åœ°å€éƒ½ç”¨6ä¸ªè¢«å†’å·åˆ†éš”çš„åå…­è¿›åˆ¶è¡¨ç¤ºã€‚ä½ å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå¦‚ä¸‹è¿™äº›ï¼š</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unicast = 00:00:00:00:00:00/01:00:00:00:00:00</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>Multicast</em>=01:00:00:00:00:00/01:00:00:00:00:00</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>Broadcast</em>=ff:ff:ff:ff:ff:ff/ff:ff:ff:ff:ff:ff</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>BGA</em>=01:80:c2:00:00:00/ff:ff:ff:ff:ff:ff</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æ³¨æ„ï¼šå¹¿æ’­åœ°å€çš„å¸§ä¹Ÿä¼šå’Œå¤šæ’­åœ°å€è§„åˆ™åŒ¹é…ï¼Œå¯ä»¥ç”¨ â€“src æ¥æ›¿ä»£è¿™ä¸ªå‘½ä»¤</p>
<p>-d, --destination [!] <em>address</em>[/mask]</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The destination MAC address. See -s (above) for more details on MAC addresses. The flag â€“dst is an alias for this option.</p>
<p>-c, --set-counter <em>pcnt bcnt</em></p>
<br>

<h3 id="æ‰©å±•é€‰é¡¹-EXTENSIONS"><a href="#æ‰©å±•é€‰é¡¹-EXTENSIONS" class="headerlink" title="æ‰©å±•é€‰é¡¹ EXTENSIONS"></a>æ‰©å±•é€‰é¡¹ EXTENSIONS</h3><p>æ³¨ï¼šæ— éœ€å‘ iptables é‚£æ ·ä½¿ç”¨ -m æ¥åŠ è½½ï¼Œebtables çš„å†…éƒ¨å®ç°é‡Œä¼šè‡ªåŠ¨åŠ è½½</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">æœªç¿»è¯‘éƒ¨åˆ†ï¼š		;;åŸå› ï¼šæœ¬è®ºæ–‡å¯èƒ½ç”¨ä¸åˆ°</span><br><span class="line"></span><br><span class="line">802_3ï¼š</span><br><span class="line"></span><br><span class="line">Specify 802.3 DSAP/SSAP fields or SNAP type. The protocol must be specified as LENGTH (see the option -p above).</span><br><span class="line">--802_3-sap [!] sap</span><br><span class="line">DSAP and SSAP are two one byte 802.3 fields. The bytes are always equal, so only one byte (hexadecimal) is needed as an argument.</span><br><span class="line">--802_3-type [!] type</span><br><span class="line">If the 802.3 DSAP and SSAP values are 0xaa then the SNAP type field must be consulted to determine the payload protocol. This is a two byte (hexadecimal) argument. Only 802.3 frames with DSAP/SSAP 0xaa are checked for type.</span><br><span class="line"></span><br><span class="line">ip6 - æœªç¿»è¯‘</span><br><span class="line">stp - æœªç¿»è¯‘</span><br></pre></td></tr></table></figure>

<p><br><strong>among</strong></p>
<p>å°†MACåœ°å€æˆ–MAC/IPåœ°å€å¯¹å’ŒæŸä¸ªMACåœ°å€åˆ—è¡¨ï¼ˆMAC/IPåœ°å€å¯¹åˆ—è¡¨ï¼‰åšåŒ¹é…ã€‚</p>
<p>MACåœ°å€æˆ–MAC/IPåœ°å€å¯¹ å¦‚ï¼šxx:xx:xx:xx:xx:xx[=yy.yy.yy.yy][,]</p>
<p>åœ¨è¯¥åˆ—è¡¨ä¸­å‡ºç°åŒä¸€MACä¸åŒIPçš„æ—¶ä¹Ÿæ˜¯ä¼šæ­£å¸¸åšåŒ¹é…çš„</p>
<p>--among-dst [!] <em>list</em> å¯¹æ¯”MACç›®çš„åœ°å€</p>
<p>--among-src [!] <em>list</em> å¯¹æ¯”MACæºåœ°å€</p>
<p>--among-dts-file [!] <em>file</em> ä»¥æ–‡ä»¶çš„æ–¹å¼åšåˆ—è¡¨</p>
<p>--among-src-file [!] <em>file</em></p>
<br>

<p><strong>arp</strong></p>
<p>æŒ‡å®š (R)ARP ç±»å‹çš„åŒ…ï¼Œå‰ææ˜¯åè®®å¿…é¡»è®¾ç½®ä¸º ARP æˆ– RARP</p>
<p>--arp-opcode [!] <em>opcode</em>   (R)ARP çš„æ“ä½œç ï¼ˆåå…­è¿›åˆ¶æˆ–å­—ç¬¦ä¸²ï¼ŒæŸ¥çœ‹å¸®åŠ© <strong>ebtables -h arp</strong>ï¼‰</p>
<p>--arp-htype [!] <em>hardware type</em>   ç¡¬ä»¶ç±»å‹ï¼Œå¯ä»¥æ˜¯åå…­è¿›åˆ¶æˆ–å­—ç¬¦ä¸² â€œ<em>Ethernet</em>â€œ (å®ƒçš„ç±»å‹æ˜¯1)ã€‚å¤§å¤šæ•°çš„ (R)ARP åŒ…éƒ½æ˜¯ä»¥ <em>Ethernet</em> ä½œä¸ºç¡¬ä»¶ç±»å‹</p>
<p>--arp-ptype [!] <em>protocol type</em>   (R)ARP æ‰€ä½¿ç”¨çš„åè®®ç±»å‹ï¼Œä¸ºåå…­è¿›åˆ¶æˆ–å­—ç¬¦ä¸² â€œ<em>IPv4</em>â€œ (å…¶è¡¨ç¤ºä¸º <strong>0x0800</strong> )ã€‚å¤§å¤šæ•°(R)ARPåŒ…éƒ½æ˜¯ IPv4</p>
<p>--arp-ip-src [!] <em>address[/mask]</em>   æŒ‡å®š (R)ARP çš„æºIPåœ°å€</p>
<p>--arp-ip-des [!]  <em>address[/mask]</em>   ç›®çš„IPåœ°å€</p>
<p>--arp-mac-des [!]  <em>address[/mask]</em>   ç›®çš„MACåœ°å€</p>
<p>--arp-mac-src [!]  <em>address[/mask]</em>   æºMACåœ°å€</p>
<p>[!] --arp-gratuitous   Checks for ARP gratuitous packets: checks equality of IPv4 source address and IPv4 destination address inside the ARP header</p>
<br>

<p><strong>ip</strong></p>
<p>æŒ‡å®š IPv4 ç±»å‹çš„åŒ…ï¼Œåè®®å¿…é¡»ä¸º IPv4</p>
<p>--ip-source [!] <em>address[/mask]</em>   =====&gt; <em>â€“ip-src</em>   æºIPåœ°å€</p>
<p>--ip-destination [!] <em>address[/mask]</em>   =====&gt; <em>â€“ip-dst</em>   ç›®çš„IPåœ°å€</p>
<p>--ip-tos [!] <em>tos</em>    (type of service) =====&gt; åå…­è¿›åˆ¶æ•° æˆ– <strong>IPv4</strong></p>
<p>--ip-protocol [!] <em>protocol</em>   =====&gt; <em>â€“ip-proto</em>   æŒ‡æ˜åè®®</p>
<p>--ip-source-port [!] <em>prot1[:port2]</em>   =====&gt; <em>â€“ip-src</em>   æºç«¯å£æˆ–ç«¯å£èŒƒå›´ï¼š6(TCP) , 17(UDP) , 33(DCCP) , 132(SCTP) ï¼Œå¿…é¡»è®¾å®š<code>--ip-protocol</code> å­—æ®µä¸ºå¯¹åº”åè®®ï¼›å¦‚æœ <em>port1</em> è¢«çœç•¥äº†ï¼Œé‚£ä¹ˆä»£è¡¨0:port2ï¼›å¦‚æœ<em>port2</em> è¢«çœç•¥äº†ï¼Œä»£è¡¨port1:65535ï¼›=====&gt; <em>â€“ip-sport</em></p>
<p>--ip-destination-port [!] <em>prot1[:port2]</em>  åŒä¸Š =====&gt; <em>â€“ip-dport</em></p>
<br>

<p><strong>limit</strong></p>
<br>

<p><strong>vlan</strong></p>
<p>æŒ‡å®š 802.1Q æ ‡ç­¾æ§åˆ¶ä¿¡æ¯ï¼ˆTag Control Informationï¼‰ å­—æ®µã€‚åè®®å¿…é¡»æŒ‡å®šä¸º 802_1Q(0x8100)</p>
<p>--vlan-id [!] <em>id</em>    æŒ‡å®š VLAN çš„æ ‡è¯†ç¬¦ (identifier filed, VID)ï¼Œåè¿›åˆ¶æ•° 0-4095</p>
<p>--vlan-prio [!] <em>prio</em>   ç”¨æˆ·ä¼˜å…ˆçº§åŸŸï¼Œåè¿›åˆ¶ 0-7ï¼ŒVID å¿…é¡»è®¾ç½®ä¸º 0 ï¼ˆâ€œnull VIDâ€ï¼‰æˆ–è€…ä¸æŒ‡å®šã€‚</p>
<p>--vlan-encap [!] <em>type</em>   è¢«å°è£…åçš„ä»¥å¤ªç½‘å¸§çš„é•¿åº¦ï¼ˆä¹Ÿå°±æ˜¯ç±»å‹ï¼‰ï¼Œä¸ºä»0x0000 åˆ° 0xFFFFçš„åå…­è¿›åˆ¶æ•°ï¼Œæˆ–è€…åœ¨<code>/etc/ethertypes</code> æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²</p>
<br>

<h3 id="è§‚å¯Ÿè€…æ‰©å±•-WATCHER-EXTENSIONS"><a href="#è§‚å¯Ÿè€…æ‰©å±•-WATCHER-EXTENSIONS" class="headerlink" title="è§‚å¯Ÿè€…æ‰©å±• WATCHER EXTENSIONS"></a>è§‚å¯Ÿè€…æ‰©å±• WATCHER EXTENSIONS</h3><p>åªå‘æ—¥å¿—æ–‡ä»¶ä¸­è®°å½•é€šè¿‡çš„å¸§ï¼Œä¸èƒ½è¿›è¡Œæ“ä½œ</p>
<p><strong>log</strong></p>
<p>log è§‚å¯Ÿè€…åªå‘ syslog å†™å…¥å¸§çš„æè¿°æ€§æ•°æ®</p>
<p>--log é»˜è®¤é€‰é¡¹ï¼Œé‡‡ç”¨<code>log-level=info,log-prefix=&quot;&quot;</code>è®¾ç½®ï¼Œä¸”ä¸è®°å½•ipï¼Œä¸è®°å½•arp</p>
<p>--log-level <em>level</em>   è®¾ç½®æ—¥å¿—ï¼ˆè®°å½•ï¼‰ç­‰çº§ï¼Œå‚è€ƒ<strong>ebtables -h log</strong> ï¼Œé»˜è®¤ä¸º <em>info</em></p>
<p>--log-prefix <em>text</em>   è®°å½•æ¡ç›®çš„å‰ç¼€ï¼Œæ–¹ä¾¿æŸ¥çœ‹è®°å½•æ–‡ä»¶çš„æ—¶å€™å¿«é€Ÿè¯†åˆ«å‡ºå“ªäº›æ¥è‡ª ebtables</p>
<p>--log-ip   å½“å¸¦æœ‰ipåè®®çš„å¸§åŒ¹é…åˆ°è§„åˆ™æ—¶ä¼šè®°å½•ip</p>
<p>--log-ip6</p>
<p>--log-arp   å½“å¸¦æœ‰ (r)arp åè®®çš„å¸§åŒ¹é…åˆ°è§„åˆ™çš„æ—¶å€™ï¼Œè®°å½•arpä¿¡æ¯</p>
<br>

<p><strong>nflog</strong></p>
<p>nflog è§‚å¯Ÿè€…ä¼šä¼ é€’åŒ¹é…çš„åŒ…ç»™ä¸€ä¸ªåå°è¿è¡Œçš„è¿›ç¨‹ï¼ˆloaded loggin backendï¼‰æ¥è®°å½•æ•°æ®åŒ…ã€‚é€šå¸¸è¿™ä¸ªåç«¯ç¨‹åºä¸º <code>nfnetlink_log</code> , è¿™ä¸ªåç«¯ç¨‹åºä¼šé€šè¿‡ <em>netlink</em> å¥—æ¥å­—ï¼ˆsocketï¼‰å‘å¤šæ’­ç»„å†…å¤šæ’­æ¥å—åˆ°åº•æ•°æ®åŒ…ï¼ˆå¸§ï¼‰ã€‚è€Œä¸”ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·ç©ºé—´çš„è¿›ç¨‹å¯ä»¥åŠ å…¥è¯¥å¤šæ’­ç»„ä»è€Œæ”¶åˆ°è¿™äº›åŒ…ã€‚</p>
<br>

<p>--nflog    ç”¨é»˜è®¤è®¾ç½®è®°å½•</p>
<p>--nflog-group <em>nlgroup</em>   æ•°æ®åŒ…æ‰€å±çš„ netlink ç»„(1 - 2^32-1)(ä»…é€‚ç”¨äºnfnetlink_log)ã€‚é»˜è®¤ä¸º1</p>
<p>--nflog-prefix <em>prefix</em>   è®°å½•æ—¥å¿—çš„å‰ç¼€ï¼ŒåŒä¸Šæ–‡ï¼Œæœ€é•¿30ä¸ªå­—ç¬¦</p>
<p>--nflog-range <em>size</em>   è§„å®šå¤šå°‘å­—èŠ‚è¢«æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼ˆåªå¯¹nfnetlink_logæœ‰æ•ˆï¼‰ï¼Œä¸”ä¸€èˆ¬ nfnetlink_log å®ä¾‹ä¼šæŒ‡å®šè‡ªå·±çš„èŒƒå›´ï¼Œè¿™ä¸ªé€‰é¡¹ä¼šè¦†ç›–é‚£ä¸ªé€‰é¡¹ã€‚</p>
<p>--nflog-threshold <em>size</em>    å‘é€åˆ°ç”¨æˆ·ç©ºé—´ä¹‹å‰è¦åœ¨å†…æ ¸ä¸­æ’é˜Ÿçš„åŒ…çš„æ•°é‡ (ä»…é€‚ç”¨äºnfnetlink_log)ã€‚å€¼è¶Šå¤§ï¼Œæ¯ä¸ªåŒ…çš„å¼€é”€å°±è¶Šå°‘ï¼Œä½†æ˜¯ä¼šå¢åŠ å»¶è¿Ÿï¼Œç›´åˆ°åŒ…åˆ°è¾¾ç”¨æˆ·ç©ºé—´ã€‚é»˜è®¤å€¼æ˜¯1ã€‚</p>
<br>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ulog - æœªç¿»è¯‘</span><br></pre></td></tr></table></figure>

<br>

<h3 id="ç›®æ ‡æ‰©å±•-TARGET-EXTENSIONS"><a href="#ç›®æ ‡æ‰©å±•-TARGET-EXTENSIONS" class="headerlink" title="ç›®æ ‡æ‰©å±• TARGET EXTENSIONS"></a>ç›®æ ‡æ‰©å±• TARGET EXTENSIONS</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arpreply - æœªç¿»è¯‘</span><br><span class="line">mark - æœªç¿»è¯‘</span><br></pre></td></tr></table></figure>

<br>

<p><strong>dnat</strong></p>
<p>è¯¥åŠ¨ä½œ(target)åªèƒ½ç”¨åœ¨ BROUTING é“¾ï¼Œå’Œ nat è¡¨çš„ PREROUTINGã€OUTPUTé“¾ã€‚æŒ‡å®šäº†ç›®çš„MACåœ°å€å¿…é¡»è¦è¢«æ”¹å˜</p>
<p>--to-destination <em>address</em>   =====&gt; <strong>â€“to-dst</strong></p>
<p>--dnat-target <em>target</em>   æŒ‡å®šäº†æ ‡å‡†åŠ¨ä½œï¼ˆtargetï¼‰ã€‚å› ä¸ºåœ¨ dnat å ebtables è¿˜éœ€è¦çŸ¥é“æ€ä¹ˆå¤„ç†ä¸€ä¸ªè¢« dnated çš„å¸§ï¼Œé»˜è®¤æ˜¯ <strong>ACCEPT</strong>ï¼Œ å°†å…¶è®¾ç½®ä¸º <strong>CONTINUE</strong> å¯ä»¥è®©ä½ åœ¨åŒä¸€ä¸ªå¸§ä¸Šä½¿ç”¨å¤šä¸ªåŠ¨ä½œæ‰©å±•ï¼ˆmultiple target extensions)ã€‚è®¾ç½®ä¸º <strong>DROP</strong> åªåœ¨ BROUTING é“¾ä¸­æœ‰ç”¨ï¼Œå½“ç„¶æ­¤æ—¶è¿˜ä¸å¦‚ç”¨ redirect æ›´åˆç†å‘¢ã€‚è¿˜å¯ä»¥è®¾ç½®ä¸º <strong>RETURN</strong> ï¼Œæ³¨æ„åœ¨ åŸºç¡€é“¾ï¼ˆbase chainï¼Œåº”è¯¥æŒ‡çš„æ˜¯æœ€å¼€å¤´çš„é“¾ï¼Œå› ä¸ºå†…æ ¸ä¸çŸ¥é“è¿˜å¾€å“ªé‡Œè¿”å›äº†ï¼ï¼‰ä¸­ä½¿ç”¨ RETURN æ˜¯ä¸å…è®¸çš„ã€‚</p>
<br>

<p><strong>redirect</strong></p>
<p>é‡å®šå‘ç›®æ ‡ï¼ˆtargetï¼Œæˆ–è¯‘ä¸ºåŠ¨ä½œï¼‰å°†æŠŠMACç›®æ ‡åœ°å€æ›´æ”¹ä¸ºå¸§åˆ°è¾¾çš„æ¡¥æ¥è®¾å¤‡çš„ç›®æ ‡åœ°å€ã€‚æ­¤ target åªèƒ½åœ¨brouteè¡¨çš„BROUTINGé“¾å’Œnatè¡¨çš„PREROUTINGé“¾ä¸­ä½¿ç”¨ã€‚åœ¨BROUTINGé“¾ä¸­ï¼Œä½¿ç”¨æ¡¥ç«¯å£çš„MACåœ°å€ä½œä¸ºç›®æ ‡åœ°å€ï¼Œåœ¨PREROUTINGé“¾ä¸­ä½¿ç”¨æ¡¥çš„MACåœ°å€ã€‚</p>
<p>--redirect-target <em>target</em>   æŒ‡å®šæ ‡å‡†targetã€‚åœ¨MACé‡å®šå‘ä¹‹åï¼Œè§„åˆ™ä»ç„¶å¿…é¡»ç»™å‡ºä¸€ä¸ªæ ‡å‡†ç›®æ ‡ï¼Œä»¥ä¾¿ebtablesçŸ¥é“è¯¥åšä»€ä¹ˆã€‚é»˜è®¤ç›®æ ‡æ˜¯ACCEPTã€‚è€Œä½¿ç”¨ CONTINUE å¯ä»¥è®©æ‚¨åœ¨åŒä¸€å¸§ä¸Šä½¿ç”¨å¤šä¸ªç›®æ ‡æ‰©å±•ã€‚åœ¨BROUTING é“¾ä¸Šä½¿ç”¨ DROP ä¼šè®©å¸§è¢«è·¯ç”±ã€‚ä¹Ÿå…è®¸ä½¿ç”¨ RETURNã€‚æ³¨æ„ï¼Œä¸å…è®¸åœ¨åŸºé“¾ä¸­ä½¿ç”¨RETURNã€‚</p>
<br>

<p><strong>snat</strong></p>
<p>è¿™ä¸ªåŠ¨ä½œåªèƒ½è¢«ç”¨åœ¨ nat è¡¨çš„ POSTROUTING é“¾ï¼Œå®ƒæŒ‡å®šæºMACåœ°å€å¿…é¡»è¢«æ”¹å˜</p>
<p>--to-source <em>address</em>    =====&gt; <strong>â€“to-src</strong></p>
<p>--snat-target <em>target</em>    æŒ‡å®šä¸€ä¸ªæ ‡å‡†åŠ¨ä½œï¼Œé™¤äº†ä¸èƒ½ä½¿ç”¨ DROP ä¹‹å¤–ï¼Œå…¶ä½™ä¸ä¸Šæ–‡ä¸€æ ·</p>
<p>--snat-arp    å¦‚æœåŒ…æ˜¯arpæ¶ˆæ¯ï¼Œå¹¶ä¸”arpå¤´ä¸­çš„ç¡¬ä»¶åœ°å€é•¿åº¦ä¸º6å­—èŠ‚ï¼Œé‚£ä¹ˆè¿˜éœ€è¦æ›´æ”¹arpå¤´ä¸­çš„ç¡¬ä»¶æºåœ°å€ã€‚</p>
<br>


      </div>
      
      <footer class="post-footer">
        
        <nav class="post-nav"><a class="prev" href="/2019/06/10/SQL-æ³¨å…¥ä¹‹å‘/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">SQL æ³¨å…¥ä¹‹å‘</span>
        <span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
      </a>
    <a class="next" href="/2019/04/30/iptables/">
        <span class="next-text nav-default">iptables</span>
        <span class="prev-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:bin.ring0@foxmail.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/pwn4justice" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://hexo.io/">Hexo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2019<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">pwn4justice</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
